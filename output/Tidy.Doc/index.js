// Generated by purs version 0.15.4
import * as Control_Alternative from "../Control.Alternative/index.js";
import * as Control_Category from "../Control.Category/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Function from "../Data.Function/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Monoid from "../Data.Monoid/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Ordering from "../Data.Ordering/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_String_CodePoints from "../Data.String.CodePoints/index.js";
import * as Data_String_CodeUnits from "../Data.String.CodeUnits/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as Dodo from "../Dodo/index.js";
import * as Dodo_Internal from "../Dodo.Internal/index.js";
import * as Tidy_Util from "../Tidy.Util/index.js";
var mempty = /* #__PURE__ */ Data_Monoid.mempty(Dodo_Internal.monoidDoc);
var sort = /* #__PURE__ */ Data_Array.sort(Data_Ord.ordInt);
var eq = /* #__PURE__ */ Data_Eq.eq(Data_String_CodePoints.eqCodePoint);
var voidLeft = /* #__PURE__ */ Data_Functor.voidLeft(Data_Maybe.functorMaybe);
var guard = /* #__PURE__ */ Control_Alternative.guard(Data_Maybe.alternativeMaybe);
var power = /* #__PURE__ */ Data_Monoid.power(Data_Monoid.monoidString);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var lines = /* #__PURE__ */ Dodo.lines(Data_Foldable.foldableArray);
var intercalate = /* #__PURE__ */ Data_Foldable.intercalate(Data_Foldable.foldableArray)(Dodo_Internal.monoidDoc);
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordInt);
var append = /* #__PURE__ */ Data_Semigroup.append(Dodo_Internal.semigroupDoc);
var min = /* #__PURE__ */ Data_Ord.min(Data_Ord.ordInt);
var identity = /* #__PURE__ */ Control_Category.identity(Control_Category.categoryFn);
var ForceNone = /* #__PURE__ */ (function () {
    function ForceNone() {

    };
    ForceNone.value = new ForceNone();
    return ForceNone;
})();
var ForceSpace = /* #__PURE__ */ (function () {
    function ForceSpace() {

    };
    ForceSpace.value = new ForceSpace();
    return ForceSpace;
})();
var ForceBreak = /* #__PURE__ */ (function () {
    function ForceBreak() {

    };
    ForceBreak.value = new ForceBreak();
    return ForceBreak;
})();
var LeadingComment = function (x) {
    return x;
};
var TrailingComment = function (x) {
    return x;
};
var FormatDoc = function (x) {
    return x;
};
var sourceBreak = function (n) {
    return function (v) {
        return {
            doc: v.doc,
            isEmpty: false,
            leading: {
                doc: v.leading.doc,
                left: v.leading.left,
                lines: v.leading.lines + n | 0,
                multiline: v.leading.multiline,
                right: v.leading.right
            },
            multiline: v.multiline,
            trailing: v.trailing
        };
    };
};
var softSpaceDoc = /* #__PURE__ */ Dodo.flexAlt(mempty)(Dodo.space);
var mapDocs = function (k) {
    return function (v) {
        if (v.isEmpty) {
            return v;
        };
        if (Data_Boolean.otherwise) {
            return {
                doc: k(v.doc),
                isEmpty: v.isEmpty,
                leading: {
                    doc: k(v.leading.doc),
                    left: v.leading.left,
                    lines: v.leading.lines,
                    multiline: v.leading.multiline,
                    right: v.leading.right
                },
                multiline: v.multiline,
                trailing: {
                    doc: k(v.trailing.doc),
                    left: v.trailing.left,
                    multiline: v.trailing.multiline,
                    right: v.trailing.right
                }
            };
        };
        throw new Error("Failed pattern match at Tidy.Doc (line 470, column 1 - line 470, column 68): " + [ k.constructor.name, v.constructor.name ]);
    };
};
var mapDoc = function (k) {
    return function (v) {
        if (v.isEmpty) {
            return v;
        };
        if (Data_Boolean.otherwise) {
            return {
                doc: k(v.doc),
                isEmpty: v.isEmpty,
                leading: v.leading,
                multiline: v.multiline,
                trailing: v.trailing
            };
        };
        throw new Error("Failed pattern match at Tidy.Doc (line 465, column 1 - line 465, column 67): " + [ k.constructor.name, v.constructor.name ]);
    };
};
var locally = function (k) {
    return function (v) {
        return {
            doc: Dodo.locally(k)(v.doc),
            isEmpty: v.isEmpty,
            leading: v.leading,
            multiline: v.multiline,
            trailing: v.trailing
        };
    };
};
var isEmpty = function (v) {
    return v.isEmpty;
};
var indent = /* #__PURE__ */ mapDocs(Dodo.indent);
var formatBlockComment = function ($187) {
    return (function (v) {
        if (v instanceof Data_Maybe.Nothing) {
            return new Data_Tuple.Tuple(false, mempty);
        };
        if (v instanceof Data_Maybe.Just) {
            var prefixSpaces = Data_Array.head(sort(Data_Array.mapMaybe(function (str) {
                var spaces = Data_String_CodeUnits.length(Data_String_CodePoints.takeWhile(eq(Data_String_CodePoints.codePointFromChar(" ")))(str));
                return voidLeft(guard(spaces < Data_String_CodeUnits.length(str)))(spaces);
            })(v.value0.tail)));
            if (prefixSpaces instanceof Data_Maybe.Nothing) {
                return new Data_Tuple.Tuple(false, Dodo.text(v.value0.head));
            };
            if (prefixSpaces instanceof Data_Maybe.Just) {
                return new Data_Tuple.Tuple(true, Dodo.withPosition(function (pos) {
                    var newIndent = (function () {
                        var $111 = prefixSpaces.value0 < pos.indent;
                        if ($111) {
                            return 0;
                        };
                        return prefixSpaces.value0;
                    })();
                    var spaces = power(" ")(newIndent);
                    var tailDocs = map(function (str) {
                        return Dodo.text(Data_Maybe.fromMaybe(str)(Data_String_CodeUnits.stripPrefix(spaces)(str)));
                    })(v.value0.tail);
                    return lines([ Dodo.text(v.value0.head), Dodo.locally(function (prev) {
                        var $112 = newIndent < prev.indent;
                        if ($112) {
                            return {
                                indent: newIndent,
                                indentSpaces: spaces,
                                indentUnit: prev.indentUnit,
                                indentWidth: prev.indentWidth,
                                pageWidth: prev.pageWidth,
                                ribbonRatio: prev.ribbonRatio
                            };
                        };
                        return prev;
                    })(intercalate(Dodo["break"])(tailDocs)) ]);
                }));
            };
            throw new Error("Failed pattern match at Tidy.Doc (line 204, column 5 - line 224, column 14): " + [ prefixSpaces.constructor.name ]);
        };
        throw new Error("Failed pattern match at Tidy.Doc (line 200, column 54 - line 234, column 21): " + [ v.constructor.name ]);
    })(Data_Array.uncons(Tidy_Util.splitLines($187)));
};
var forceMinSourceBreaks = function (n) {
    return function (v) {
        if (v.isEmpty) {
            return v;
        };
        if (Data_Boolean.otherwise) {
            return {
                doc: v.doc,
                isEmpty: v.isEmpty,
                leading: {
                    doc: v.leading.doc,
                    left: v.leading.left,
                    lines: max(v.leading.lines)(n),
                    multiline: v.leading.multiline,
                    right: v.leading.right
                },
                multiline: v.multiline,
                trailing: v.trailing
            };
        };
        throw new Error("Failed pattern match at Tidy.Doc (line 314, column 1 - line 314, column 68): " + [ n.constructor.name, v.constructor.name ]);
    };
};
var force = function (k) {
    return function (f) {
        return function (m) {
            return function (doc) {
                if (f instanceof ForceBreak) {
                    return new Data_Tuple.Tuple(true, append(Dodo["break"])(doc));
                };
                return new Data_Tuple.Tuple(m, k(doc));
            };
        };
    };
};
var flexGroup = function (v) {
    if (v.multiline) {
        return v;
    };
    if (Data_Boolean.otherwise) {
        return {
            doc: Dodo.flexGroup(v.doc),
            isEmpty: v.isEmpty,
            leading: v.leading,
            multiline: v.multiline,
            trailing: v.trailing
        };
    };
    throw new Error("Failed pattern match at Tidy.Doc (line 289, column 1 - line 289, column 50): " + [ v.constructor.name ]);
};
var flattenMax = function (n) {
    return function (v) {
        return {
            doc: v.doc,
            isEmpty: v.isEmpty,
            leading: {
                doc: v.leading.doc,
                left: v.leading.left,
                lines: min(v.leading.lines)(n),
                multiline: v.leading.multiline,
                right: v.leading.right
            },
            multiline: v.multiline,
            trailing: v.trailing
        };
    };
};
var flatten = /* #__PURE__ */ flattenMax(0);
var eqForceBreak = {
    eq: function (x) {
        return function (y) {
            if (x instanceof ForceNone && y instanceof ForceNone) {
                return true;
            };
            if (x instanceof ForceSpace && y instanceof ForceSpace) {
                return true;
            };
            if (x instanceof ForceBreak && y instanceof ForceBreak) {
                return true;
            };
            return false;
        };
    }
};
var eq2 = /* #__PURE__ */ Data_Eq.eq(eqForceBreak);
var ordForceBreak = {
    compare: function (x) {
        return function (y) {
            if (x instanceof ForceNone && y instanceof ForceNone) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof ForceNone) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof ForceNone) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof ForceSpace && y instanceof ForceSpace) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof ForceSpace) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof ForceSpace) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof ForceBreak && y instanceof ForceBreak) {
                return Data_Ordering.EQ.value;
            };
            throw new Error("Failed pattern match at Tidy.Doc (line 0, column 0 - line 0, column 0): " + [ x.constructor.name, y.constructor.name ]);
        };
    },
    Eq0: function () {
        return eqForceBreak;
    }
};
var max1 = /* #__PURE__ */ Data_Ord.max(ordForceBreak);
var breaks = function (fl) {
    return function (n) {
        if (n >= 2) {
            return append(Dodo["break"])(Dodo["break"]);
        };
        if (n === 1) {
            return Dodo["break"];
        };
        if (Data_Boolean.otherwise) {
            if (fl instanceof ForceBreak) {
                return Dodo["break"];
            };
            if (fl instanceof ForceSpace) {
                return Dodo.space;
            };
            if (fl instanceof ForceNone) {
                return mempty;
            };
            throw new Error("Failed pattern match at Tidy.Doc (line 430, column 17 - line 433, column 26): " + [ fl.constructor.name ]);
        };
        throw new Error("Failed pattern match at Tidy.Doc (line 426, column 1 - line 426, column 47): " + [ fl.constructor.name, n.constructor.name ]);
    };
};
var breakDoc = function (br) {
    return function (doc) {
        if (Dodo_Internal.isEmpty(doc)) {
            return doc;
        };
        if (Data_Boolean.otherwise) {
            if (br instanceof ForceBreak) {
                return append(Dodo["break"])(doc);
            };
            if (br instanceof ForceSpace) {
                return append(Dodo.space)(doc);
            };
            if (br instanceof ForceNone) {
                return doc;
            };
            throw new Error("Failed pattern match at Tidy.Doc (line 421, column 17 - line 424, column 23): " + [ br.constructor.name ]);
        };
        throw new Error("Failed pattern match at Tidy.Doc (line 418, column 1 - line 418, column 51): " + [ br.constructor.name, doc.constructor.name ]);
    };
};
var flexDoubleBreak = function (v) {
    return function (v1) {
        if (v.isEmpty) {
            return v1;
        };
        if (v1.isEmpty) {
            return v;
        };
        if (Data_Boolean.otherwise) {
            var docLeft = append(v.doc)(breakDoc(v.trailing.left)(v.trailing.doc));
            var docRight = append(v1.leading.doc)(breakDoc(v1.leading.right)(v1.doc));
            var $139 = v1.leading.lines >= 2 || v.multiline;
            if ($139) {
                return {
                    doc: append(docLeft)(append(Dodo["break"])(append(Dodo["break"])(docRight))),
                    isEmpty: v.isEmpty,
                    leading: v.leading,
                    multiline: true,
                    trailing: v1.trailing
                };
            };
            return {
                doc: append(Dodo.flexSelect(docLeft)(mempty)(Dodo["break"]))(append(Dodo["break"])(docRight)),
                isEmpty: v.isEmpty,
                leading: v.leading,
                multiline: true,
                trailing: v1.trailing
            };
        };
        throw new Error("Failed pattern match at Tidy.Doc (line 393, column 1 - line 393, column 49): " + [ v.constructor.name, v1.constructor.name ]);
    };
};
var joinDoc = function (spaceFn) {
    return function (v) {
        return function (v1) {
            if (v.isEmpty) {
                return v1;
            };
            if (v1.isEmpty) {
                return v;
            };
            if (Data_Boolean.otherwise) {
                var docLeft = append(v.doc)(breakDoc(v.trailing.left)(v.trailing.doc));
                var docRight = append(v1.leading.doc)(breakDoc(v1.leading.right)(v1.doc));
                var $145 = v1.leading.lines > 0;
                if ($145) {
                    return {
                        doc: append(docLeft)(append(breaks(ForceBreak.value)(v1.leading.lines))(docRight)),
                        isEmpty: v.isEmpty,
                        leading: v.leading,
                        multiline: true,
                        trailing: v1.trailing
                    };
                };
                var v2 = spaceFn(max1(v.trailing.right)(v1.leading.left))(v1.leading.multiline || v1.multiline)(docRight);
                return {
                    doc: append(docLeft)(v2.value1),
                    isEmpty: v.isEmpty,
                    leading: v.leading,
                    multiline: v.trailing.multiline || (v.multiline || v2.value0),
                    trailing: v1.trailing
                };
            };
            throw new Error("Failed pattern match at Tidy.Doc (line 435, column 1 - line 435, column 102): " + [ spaceFn.constructor.name, v.constructor.name, v1.constructor.name ]);
        };
    };
};
var flexSoftBreak = /* #__PURE__ */ joinDoc(function (f) {
    return function (m) {
        return function (doc) {
            if (f instanceof ForceBreak) {
                return new Data_Tuple.Tuple(true, append(Dodo["break"])(doc));
            };
            if (f instanceof ForceSpace) {
                if (m) {
                    return new Data_Tuple.Tuple(true, append(Dodo.space)(doc));
                };
                return new Data_Tuple.Tuple(false, Dodo.flexGroup(append(Dodo.spaceBreak)(doc)));
            };
            if (f instanceof ForceNone) {
                if (m) {
                    return new Data_Tuple.Tuple(true, append(Dodo["break"])(doc));
                };
                return new Data_Tuple.Tuple(false, Dodo.flexGroup(append(Dodo.softBreak)(doc)));
            };
            throw new Error("Failed pattern match at Tidy.Doc (line 358, column 37 - line 370, column 59): " + [ f.constructor.name ]);
        };
    };
});
var flexSoftSpace = /* #__PURE__ */ joinDoc(function (f) {
    return function (m) {
        return function (doc) {
            if (f instanceof ForceBreak) {
                return new Data_Tuple.Tuple(true, append(Dodo["break"])(doc));
            };
            if (f instanceof ForceSpace) {
                if (m) {
                    return new Data_Tuple.Tuple(true, append(Dodo.space)(doc));
                };
                return new Data_Tuple.Tuple(false, Dodo.flexGroup(append(Dodo.space)(doc)));
            };
            if (f instanceof ForceNone) {
                if (m) {
                    return new Data_Tuple.Tuple(true, append(softSpaceDoc)(doc));
                };
                return new Data_Tuple.Tuple(false, Dodo.flexGroup(append(softSpaceDoc)(doc)));
            };
            throw new Error("Failed pattern match at Tidy.Doc (line 343, column 37 - line 355, column 57): " + [ f.constructor.name ]);
        };
    };
});
var flexSpaceBreak = /* #__PURE__ */ joinDoc(function (f) {
    return function (m) {
        return function (doc) {
            if (f instanceof ForceBreak) {
                return new Data_Tuple.Tuple(true, append(Dodo["break"])(doc));
            };
            if (m) {
                return new Data_Tuple.Tuple(true, append(Dodo.spaceBreak)(doc));
            };
            return new Data_Tuple.Tuple(false, Dodo.flexGroup(append(Dodo.spaceBreak)(doc)));
        };
    };
});
var semigroupFormatDoc = {
    append: /* #__PURE__ */ joinDoc(/* #__PURE__ */ force(identity))
};
var softBreak = /* #__PURE__ */ joinDoc(function (f) {
    return function (m) {
        return function (doc) {
            if (f instanceof ForceBreak) {
                return new Data_Tuple.Tuple(true, append(Dodo["break"])(doc));
            };
            if (f instanceof ForceSpace) {
                return new Data_Tuple.Tuple(m, append(Dodo.spaceBreak)(doc));
            };
            if (f instanceof ForceNone) {
                return new Data_Tuple.Tuple(m, append(Dodo.softBreak)(doc));
            };
            throw new Error("Failed pattern match at Tidy.Doc (line 373, column 33 - line 379, column 36): " + [ f.constructor.name ]);
        };
    };
});
var softSpace = /* #__PURE__ */ joinDoc(function (f) {
    return function (m) {
        return function (doc) {
            if (f instanceof ForceBreak) {
                return new Data_Tuple.Tuple(true, append(Dodo["break"])(doc));
            };
            if (f instanceof ForceSpace) {
                return new Data_Tuple.Tuple(m, append(Dodo.space)(doc));
            };
            if (f instanceof ForceNone) {
                return new Data_Tuple.Tuple(m, append(softSpaceDoc)(doc));
            };
            throw new Error("Failed pattern match at Tidy.Doc (line 382, column 33 - line 388, column 34): " + [ f.constructor.name ]);
        };
    };
});
var space = /* #__PURE__ */ joinDoc(/* #__PURE__ */ force(/* #__PURE__ */ append(Dodo.space)));
var spaceBreak = /* #__PURE__ */ joinDoc(/* #__PURE__ */ force(/* #__PURE__ */ append(Dodo.spaceBreak)));
var toDoc = function (v) {
    if (v.isEmpty) {
        return mempty;
    };
    if (Data_Boolean.otherwise) {
        return append(v.leading.doc)(append(breakDoc(v.leading.right)(v.doc))(breakDoc(v.trailing.left)(v.trailing.doc)));
    };
    throw new Error("Failed pattern match at Tidy.Doc (line 482, column 1 - line 482, column 40): " + [ v.constructor.name ]);
};
var semigroupLeadingComment = {
    append: function (v) {
        return function (v1) {
            if (Dodo_Internal.isEmpty(v.doc)) {
                return {
                    doc: v1.doc,
                    left: max1(v.left)(v1.left),
                    lines: v.lines + v1.lines | 0,
                    multiline: v1.multiline,
                    right: v1.right
                };
            };
            if (Dodo_Internal.isEmpty(v1.doc)) {
                return {
                    doc: append(v.doc)(breaks(ForceNone.value)(v1.lines)),
                    left: v.left,
                    lines: v.lines,
                    multiline: v.multiline || v1.lines > 0,
                    right: (function () {
                        var $164 = v1.lines > 0;
                        if ($164) {
                            return ForceNone.value;
                        };
                        return max1(v.right)(v1.right);
                    })()
                };
            };
            if (Data_Boolean.otherwise) {
                var br = max1(v.right)(v1.left);
                var $165 = v1.lines > 0 || eq2(br)(ForceBreak.value);
                if ($165) {
                    return {
                        doc: append(v.doc)(append(breaks(ForceBreak.value)(v1.lines))(v1.doc)),
                        left: v.left,
                        lines: v.lines,
                        multiline: true,
                        right: v1.right
                    };
                };
                return {
                    doc: append(v.doc)(breakDoc(br)(v1.doc)),
                    left: v.left,
                    lines: v.lines,
                    multiline: v.multiline || v1.multiline,
                    right: v1.right
                };
            };
            throw new Error("Failed pattern match at Tidy.Doc (line 74, column 1 - line 104, column 14): " + [ v.constructor.name, v1.constructor.name ]);
        };
    }
};
var append1 = /* #__PURE__ */ Data_Semigroup.append(semigroupLeadingComment);
var leadingBlockComment = function (str) {
    return function (v) {
        var v1 = formatBlockComment(str);
        var comm = {
            doc: v1.value1,
            left: ForceSpace.value,
            lines: 0,
            multiline: v1.value0,
            right: ForceSpace.value
        };
        return {
            doc: v.doc,
            isEmpty: false,
            leading: append1(comm)(v.leading),
            multiline: v.multiline,
            trailing: v.trailing
        };
    };
};
var leadingLineComment = function (str) {
    return function (v) {
        var comm = {
            doc: Dodo.text(str),
            left: ForceBreak.value,
            lines: 0,
            multiline: false,
            right: ForceBreak.value
        };
        return {
            doc: v.doc,
            isEmpty: false,
            leading: append1(comm)(v.leading),
            multiline: v.multiline,
            trailing: v.trailing
        };
    };
};
var monoidLeadingComment = /* #__PURE__ */ (function () {
    return {
        mempty: {
            doc: mempty,
            left: ForceNone.value,
            lines: 0,
            multiline: false,
            right: ForceNone.value
        },
        Semigroup0: function () {
            return semigroupLeadingComment;
        }
    };
})();
var mempty1 = /* #__PURE__ */ Data_Monoid.mempty(monoidLeadingComment);
var semigroupTrailingComment = {
    append: function (v) {
        return function (v1) {
            if (Dodo_Internal.isEmpty(v.doc)) {
                return {
                    doc: v1.doc,
                    left: max1(v.left)(v1.left),
                    multiline: v1.multiline,
                    right: v1.right
                };
            };
            if (Dodo_Internal.isEmpty(v1.doc)) {
                return {
                    doc: v.doc,
                    left: v.left,
                    multiline: v.multiline,
                    right: max1(v.right)(v1.right)
                };
            };
            if (Data_Boolean.otherwise) {
                return {
                    doc: append(v.doc)(breakDoc(max1(v.right)(v1.left))(v1.doc)),
                    left: v.left,
                    multiline: v.multiline || v1.multiline,
                    right: v1.right
                };
            };
            throw new Error("Failed pattern match at Tidy.Doc (line 115, column 1 - line 126, column 12): " + [ v.constructor.name, v1.constructor.name ]);
        };
    }
};
var append2 = /* #__PURE__ */ Data_Semigroup.append(semigroupTrailingComment);
var trailingBlockComment = function (str) {
    return function (v) {
        var v1 = formatBlockComment(str);
        var comm = {
            doc: v1.value1,
            left: ForceSpace.value,
            multiline: v1.value0,
            right: ForceSpace.value
        };
        return {
            doc: v.doc,
            isEmpty: false,
            leading: v.leading,
            multiline: v.multiline,
            trailing: append2(comm)(v.trailing)
        };
    };
};
var trailingLineComment = function (str) {
    return function (v) {
        var comm = {
            doc: Dodo.text(str),
            left: ForceSpace.value,
            multiline: false,
            right: ForceBreak.value
        };
        return {
            doc: v.doc,
            isEmpty: false,
            leading: v.leading,
            multiline: v.multiline,
            trailing: append2(comm)(v.trailing)
        };
    };
};
var monoidTrailingComment = /* #__PURE__ */ (function () {
    return {
        mempty: {
            doc: mempty,
            left: ForceNone.value,
            multiline: false,
            right: ForceNone.value
        },
        Semigroup0: function () {
            return semigroupTrailingComment;
        }
    };
})();
var mempty2 = /* #__PURE__ */ Data_Monoid.mempty(monoidTrailingComment);
var monoidFormatDoc = {
    mempty: {
        doc: mempty,
        leading: mempty1,
        isEmpty: true,
        multiline: false,
        trailing: mempty2
    },
    Semigroup0: function () {
        return semigroupFormatDoc;
    }
};
var mempty3 = /* #__PURE__ */ Data_Monoid.mempty(monoidFormatDoc);
var fromDoc = function (doc) {
    if (Dodo_Internal.isEmpty(doc)) {
        return mempty3;
    };
    if (Data_Boolean.otherwise) {
        return {
            doc: doc,
            leading: mempty1,
            isEmpty: false,
            multiline: false,
            trailing: mempty2
        };
    };
    throw new Error("Failed pattern match at Tidy.Doc (line 158, column 1 - line 158, column 42): " + [ doc.constructor.name ]);
};
var text = function ($188) {
    return fromDoc(Dodo.text($188));
};
var joinWithMap = function (dictFoldable) {
    var foldl = Data_Foldable.foldl(dictFoldable);
    return function (op) {
        return function (k) {
            var go = function (a) {
                return function (b) {
                    if (isEmpty(a)) {
                        return k(b);
                    };
                    if (Data_Boolean.otherwise) {
                        return op(a)(k(b));
                    };
                    throw new Error("Failed pattern match at Tidy.Doc (line 501, column 3 - line 503, column 29): " + [ a.constructor.name, b.constructor.name ]);
                };
            };
            return foldl(go)(mempty3);
        };
    };
};
var joinWith = function (dictFoldable) {
    return Data_Function.flip(joinWithMap(dictFoldable))(identity);
};
var $$break = /* #__PURE__ */ joinDoc(/* #__PURE__ */ force(/* #__PURE__ */ append(Dodo["break"])));
var anchor = function (v) {
    if (v.leading.lines > 0) {
        return {
            doc: v.doc,
            isEmpty: v.isEmpty,
            leading: {
                doc: v.leading.doc,
                left: v.leading.left,
                lines: 0,
                multiline: v.leading.multiline,
                right: v.leading.right
            },
            multiline: true,
            trailing: v.trailing
        };
    };
    return v;
};
var alignCurrentColumn = /* #__PURE__ */ mapDocs(Dodo.alignCurrentColumn);
var align = function ($189) {
    return mapDocs(Dodo.align($189));
};
export {
    FormatDoc,
    LeadingComment,
    TrailingComment,
    ForceNone,
    ForceSpace,
    ForceBreak,
    text,
    leadingLineComment,
    trailingLineComment,
    leadingBlockComment,
    trailingBlockComment,
    anchor,
    flatten,
    flattenMax,
    indent,
    align,
    alignCurrentColumn,
    locally,
    $$break as break,
    softBreak,
    spaceBreak,
    sourceBreak,
    forceMinSourceBreaks,
    space,
    softSpace,
    flexSpaceBreak,
    flexSoftSpace,
    flexSoftBreak,
    flexDoubleBreak,
    flexGroup,
    fromDoc,
    toDoc,
    mapDoc,
    breakDoc,
    breaks,
    joinWithMap,
    joinWith,
    eqForceBreak,
    ordForceBreak,
    semigroupLeadingComment,
    monoidLeadingComment,
    semigroupTrailingComment,
    monoidTrailingComment,
    semigroupFormatDoc,
    monoidFormatDoc
};
