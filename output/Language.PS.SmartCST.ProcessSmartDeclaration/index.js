// Generated by purs version 0.15.4
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Apply from "../Control.Apply/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Monad_Reader_Class from "../Control.Monad.Reader.Class/index.js";
import * as Control_Monad_Reader_Trans from "../Control.Monad.Reader.Trans/index.js";
import * as Control_Monad_State from "../Control.Monad.State/index.js";
import * as Control_Monad_State_Class from "../Control.Monad.State.Class/index.js";
import * as Control_Monad_State_Trans from "../Control.Monad.State.Trans/index.js";
import * as Data_Array_NonEmpty_Internal from "../Data.Array.NonEmpty.Internal/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Function from "../Data.Function/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Identity from "../Data.Identity/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Traversable from "../Data.Traversable/index.js";
import * as Language_PS_CST_Sugar_QualifiedName from "../Language.PS.CST.Sugar.QualifiedName/index.js";
import * as Language_PS_CST_Types_Declaration from "../Language.PS.CST.Types.Declaration/index.js";
import * as Language_PS_CST_Types_Leafs from "../Language.PS.CST.Types.Leafs/index.js";
import * as Language_PS_CST_Types_Module from "../Language.PS.CST.Types.Module/index.js";
import * as Language_PS_SmartCST_ProcessSmartDeclaration_Utils from "../Language.PS.SmartCST.ProcessSmartDeclaration.Utils/index.js";
import * as Language_PS_SmartCST_Types_Declaration from "../Language.PS.SmartCST.Types.Declaration/index.js";
import * as Language_PS_SmartCST_Types_SmartQualifiedName from "../Language.PS.SmartCST.Types.SmartQualifiedName/index.js";
import * as Language_PS_SmartCST_Types_SmartQualifiedNameConstructor from "../Language.PS.SmartCST.Types.SmartQualifiedNameConstructor/index.js";
var eq = /* #__PURE__ */ Data_Eq.eq(Language_PS_CST_Types_Leafs.eqProperName);
var applicativeReaderT = /* #__PURE__ */ Control_Monad_Reader_Trans.applicativeReaderT(/* #__PURE__ */ Control_Monad_State_Trans.applicativeStateT(Data_Identity.monadIdentity));
var pure = /* #__PURE__ */ Control_Applicative.pure(applicativeReaderT);
var bindReaderT = /* #__PURE__ */ Control_Monad_Reader_Trans.bindReaderT(/* #__PURE__ */ Control_Monad_State_Trans.bindStateT(Data_Identity.monadIdentity));
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit)(bindReaderT);
var modify_ = /* #__PURE__ */ Control_Monad_State_Class.modify_(/* #__PURE__ */ Control_Monad_Reader_Trans.monadStateReaderT(/* #__PURE__ */ Control_Monad_State_Trans.monadStateStateT(Data_Identity.monadIdentity)));
var eq1 = /* #__PURE__ */ Data_Eq.eq(Language_PS_CST_Types_Leafs.eqModuleName);
var bind = /* #__PURE__ */ Control_Bind.bind(bindReaderT);
var ask = /* #__PURE__ */ Control_Monad_Reader_Class.ask(/* #__PURE__ */ Control_Monad_Reader_Trans.monadAskReaderT(/* #__PURE__ */ Control_Monad_State_Trans.monadStateT(Data_Identity.monadIdentity)));
var eq2 = /* #__PURE__ */ Data_Eq.eq(Language_PS_CST_Types_Leafs.eqOpName);
var eq3 = /* #__PURE__ */ Data_Eq.eq(Language_PS_CST_Types_Leafs.eqIdent);
var map = /* #__PURE__ */ Data_Functor.map(/* #__PURE__ */ Control_Monad_Reader_Trans.functorReaderT(/* #__PURE__ */ Control_Monad_State_Trans.functorStateT(Data_Identity.functorIdentity)));
var apply = /* #__PURE__ */ Control_Apply.apply(/* #__PURE__ */ Control_Monad_Reader_Trans.applyReaderT(/* #__PURE__ */ Control_Monad_State_Trans.applyStateT(Data_Identity.monadIdentity)));
var traverse = /* #__PURE__ */ Data_Traversable.traverse(Data_Array_NonEmpty_Internal.traversableNonEmptyArray)(applicativeReaderT);
var traverse1 = /* #__PURE__ */ Data_Traversable.traverse(Data_Traversable.traversableArray)(applicativeReaderT);
var traverse2 = /* #__PURE__ */ Data_Traversable.traverse(Data_Traversable.traversableMaybe)(applicativeReaderT);
var traverse3 = /* #__PURE__ */ Data_Traversable.traverse(Language_PS_CST_Types_Leafs.traversableRecordLabeled)(applicativeReaderT);
var processSmartQualifiedNameTypeConstructor = /* #__PURE__ */ (function () {
    var smartModify = function (typeName) {
        return function (_currentImport) {
            return new Language_PS_CST_Types_Module.ImportType(typeName, new Data_Maybe.Just(Language_PS_CST_Types_Module.DataAll.value));
        };
    };
    var smartFindEqToName = function (typeName) {
        return function (v) {
            if (v instanceof Language_PS_CST_Types_Module.ImportType) {
                return eq(v.value0)(typeName);
            };
            return false;
        };
    };
    var smartCreateNew = function (typeName) {
        return new Language_PS_CST_Types_Module.ImportType(typeName, new Data_Maybe.Just(Language_PS_CST_Types_Module.DataAll.value));
    };
    return function (v) {
        if (v instanceof Language_PS_SmartCST_Types_SmartQualifiedNameConstructor.SmartQualifiedNameConstructor__Ignore) {
            return pure({
                qualModule: Data_Maybe.Nothing.value,
                qualName: v.value0
            });
        };
        if (v instanceof Language_PS_SmartCST_Types_SmartQualifiedNameConstructor.SmartQualifiedNameConstructor__Full) {
            return discard(modify_(Language_PS_SmartCST_ProcessSmartDeclaration_Utils.findAndModifyOrNew(function (v1) {
                if (v1.qualification instanceof Data_Maybe.Nothing) {
                    return false;
                };
                if (v1.qualification instanceof Data_Maybe.Just) {
                    return eq1(v.value0)(v1.qualification.value0);
                };
                throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 207, column 15 - line 209, column 67): " + [ v1.qualification.constructor.name ]);
            })(function (v1) {
                return {
                    moduleName: v1.moduleName,
                    names: Language_PS_SmartCST_ProcessSmartDeclaration_Utils.findAndModifyOrNew(smartFindEqToName(v.value2))(smartModify(v.value2))(function (v3) {
                        return smartCreateNew(v.value2);
                    })(v1.names),
                    qualification: v1.qualification
                };
            })(function (v1) {
                return {
                    moduleName: v.value0,
                    names: [ smartCreateNew(v.value2) ],
                    qualification: new Data_Maybe.Just(v.value0)
                };
            })))(function () {
                return bind(ask)(function (currentModuleName) {
                    return pure({
                        qualModule: (function () {
                            var $121 = eq1(currentModuleName)(v.value0);
                            if ($121) {
                                return Data_Maybe.Nothing.value;
                            };
                            return new Data_Maybe.Just(v.value0);
                        })(),
                        qualName: v.value1
                    });
                });
            });
        };
        if (v instanceof Language_PS_SmartCST_Types_SmartQualifiedNameConstructor.SmartQualifiedNameConstructor__Simple) {
            return discard(modify_(Language_PS_SmartCST_ProcessSmartDeclaration_Utils.findAndModifyOrNew(function (v1) {
                if (v1.qualification instanceof Data_Maybe.Nothing) {
                    return eq1(v1.moduleName)(v.value0);
                };
                if (v1.qualification instanceof Data_Maybe.Just) {
                    return false;
                };
                throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 238, column 15 - line 240, column 35): " + [ v1.qualification.constructor.name ]);
            })(function (v1) {
                return {
                    moduleName: v1.moduleName,
                    names: Language_PS_SmartCST_ProcessSmartDeclaration_Utils.findAndModifyOrNew(smartFindEqToName(v.value2))(smartModify(v.value2))(function (v3) {
                        return smartCreateNew(v.value2);
                    })(v1.names),
                    qualification: v1.qualification
                };
            })(function (v1) {
                return {
                    moduleName: v.value0,
                    names: [ smartCreateNew(v.value2) ],
                    qualification: Data_Maybe.Nothing.value
                };
            })))(function () {
                return pure({
                    qualModule: Data_Maybe.Nothing.value,
                    qualName: v.value1
                });
            });
        };
        if (v instanceof Language_PS_SmartCST_Types_SmartQualifiedNameConstructor.SmartQualifiedNameConstructor__Custom) {
            return discard(modify_(Language_PS_SmartCST_ProcessSmartDeclaration_Utils.findAndModifyOrNew(function (v1) {
                if (v1.qualification instanceof Data_Maybe.Nothing) {
                    return false;
                };
                if (v1.qualification instanceof Data_Maybe.Just) {
                    return eq1(v1.qualification.value0)(v.value1);
                };
                throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 262, column 15 - line 264, column 65): " + [ v1.qualification.constructor.name ]);
            })(function (v1) {
                return {
                    moduleName: v1.moduleName,
                    names: Language_PS_SmartCST_ProcessSmartDeclaration_Utils.findAndModifyOrNew(smartFindEqToName(v.value3))(smartModify(v.value3))(function (v3) {
                        return smartCreateNew(v.value3);
                    })(v1.names),
                    qualification: v1.qualification
                };
            })(function (v1) {
                return {
                    moduleName: v.value0,
                    names: [ smartCreateNew(v.value3) ],
                    qualification: new Data_Maybe.Just(v.value1)
                };
            })))(function () {
                return bind(ask)(function (currentModuleName) {
                    return pure({
                        qualModule: (function () {
                            var $136 = eq1(currentModuleName)(v.value1);
                            if ($136) {
                                return Data_Maybe.Nothing.value;
                            };
                            return new Data_Maybe.Just(v.value1);
                        })(),
                        qualName: v.value2
                    });
                });
            });
        };
        throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 202, column 7 - line 289, column 14): " + [ v.constructor.name ]);
    };
})();
var processSmartQualifiedName = function (smartFindEqToName) {
    return function (smartModify) {
        return function (smartCreateNew) {
            return function (v) {
                if (v instanceof Language_PS_SmartCST_Types_SmartQualifiedName.SmartQualifiedName__Ignore) {
                    return pure({
                        qualModule: Data_Maybe.Nothing.value,
                        qualName: v.value0
                    });
                };
                if (v instanceof Language_PS_SmartCST_Types_SmartQualifiedName.SmartQualifiedName__Full) {
                    return discard(modify_(Language_PS_SmartCST_ProcessSmartDeclaration_Utils.findAndModifyOrNew(function (v1) {
                        if (v1.qualification instanceof Data_Maybe.Nothing) {
                            return false;
                        };
                        if (v1.qualification instanceof Data_Maybe.Just) {
                            return eq1(v.value0)(v1.qualification.value0);
                        };
                        throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 43, column 15 - line 45, column 67): " + [ v1.qualification.constructor.name ]);
                    })(function (v1) {
                        return {
                            moduleName: v1.moduleName,
                            names: Language_PS_SmartCST_ProcessSmartDeclaration_Utils.findAndModifyOrNew(smartFindEqToName(v.value1))(smartModify(v.value1))(function (v3) {
                                return smartCreateNew(v.value1);
                            })(v1.names),
                            qualification: v1.qualification
                        };
                    })(function (v1) {
                        return {
                            moduleName: v.value0,
                            names: [ smartCreateNew(v.value1) ],
                            qualification: new Data_Maybe.Just(v.value0)
                        };
                    })))(function () {
                        return bind(ask)(function (currentModuleName) {
                            return pure({
                                qualModule: (function () {
                                    var $147 = eq1(currentModuleName)(v.value0);
                                    if ($147) {
                                        return Data_Maybe.Nothing.value;
                                    };
                                    return new Data_Maybe.Just(v.value0);
                                })(),
                                qualName: v.value1
                            });
                        });
                    });
                };
                if (v instanceof Language_PS_SmartCST_Types_SmartQualifiedName.SmartQualifiedName__Simple) {
                    return discard(modify_(Language_PS_SmartCST_ProcessSmartDeclaration_Utils.findAndModifyOrNew(function (v1) {
                        if (v1.qualification instanceof Data_Maybe.Nothing) {
                            return eq1(v1.moduleName)(v.value0);
                        };
                        if (v1.qualification instanceof Data_Maybe.Just) {
                            return false;
                        };
                        throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 74, column 15 - line 76, column 35): " + [ v1.qualification.constructor.name ]);
                    })(function (v1) {
                        return {
                            moduleName: v1.moduleName,
                            names: Language_PS_SmartCST_ProcessSmartDeclaration_Utils.findAndModifyOrNew(smartFindEqToName(v.value1))(smartModify(v.value1))(function (v3) {
                                return smartCreateNew(v.value1);
                            })(v1.names),
                            qualification: v1.qualification
                        };
                    })(function (v1) {
                        return {
                            moduleName: v.value0,
                            names: [ smartCreateNew(v.value1) ],
                            qualification: Data_Maybe.Nothing.value
                        };
                    })))(function () {
                        return pure({
                            qualModule: Data_Maybe.Nothing.value,
                            qualName: v.value1
                        });
                    });
                };
                if (v instanceof Language_PS_SmartCST_Types_SmartQualifiedName.SmartQualifiedName__Custom) {
                    return discard(modify_(Language_PS_SmartCST_ProcessSmartDeclaration_Utils.findAndModifyOrNew(function (v1) {
                        if (v1.qualification instanceof Data_Maybe.Nothing) {
                            return false;
                        };
                        if (v1.qualification instanceof Data_Maybe.Just) {
                            return eq1(v1.qualification.value0)(v.value1);
                        };
                        throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 98, column 15 - line 100, column 65): " + [ v1.qualification.constructor.name ]);
                    })(function (v1) {
                        return {
                            moduleName: v1.moduleName,
                            names: Language_PS_SmartCST_ProcessSmartDeclaration_Utils.findAndModifyOrNew(smartFindEqToName(v.value2))(smartModify(v.value2))(function (v3) {
                                return smartCreateNew(v.value2);
                            })(v1.names),
                            qualification: v1.qualification
                        };
                    })(function (v1) {
                        return {
                            moduleName: v.value0,
                            names: [ smartCreateNew(v.value2) ],
                            qualification: new Data_Maybe.Just(v.value1)
                        };
                    })))(function () {
                        return bind(ask)(function (currentModuleName) {
                            return pure({
                                qualModule: (function () {
                                    var $160 = eq1(currentModuleName)(v.value1);
                                    if ($160) {
                                        return Data_Maybe.Nothing.value;
                                    };
                                    return new Data_Maybe.Just(v.value1);
                                })(),
                                qualName: v.value2
                            });
                        });
                    });
                };
                throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 38, column 3 - line 125, column 14): " + [ v.constructor.name ]);
            };
        };
    };
};
var processSmartQualifiedNameClass = /* #__PURE__ */ (function () {
    return processSmartQualifiedName(function (expectedName) {
        return function (v) {
            if (v instanceof Language_PS_CST_Types_Module.ImportClass) {
                return eq(v.value0)(expectedName);
            };
            return false;
        };
    })(function (name) {
        return function (currentImport) {
            return currentImport;
        };
    })(Language_PS_CST_Types_Module.ImportClass.create);
})();
var processSmartQualifiedNameKind = /* #__PURE__ */ (function () {
    return processSmartQualifiedName(function (expectedName) {
        return function (v) {
            if (v instanceof Language_PS_CST_Types_Module.ImportKind) {
                return eq(v.value0)(expectedName);
            };
            return false;
        };
    })(function (name) {
        return function (currentImport) {
            return currentImport;
        };
    })(Language_PS_CST_Types_Module.ImportKind.create);
})();
var processSmartQualifiedNameOp = /* #__PURE__ */ (function () {
    return processSmartQualifiedName(function (expectedName) {
        return function (v) {
            if (v instanceof Language_PS_CST_Types_Module.ImportOp) {
                return eq2(v.value0)(expectedName);
            };
            return false;
        };
    })(function (name) {
        return function (currentImport) {
            return currentImport;
        };
    })(Language_PS_CST_Types_Module.ImportOp.create);
})();
var processSmartQualifiedNameType = /* #__PURE__ */ processSmartQualifiedName(function (expectedName) {
    return function (v) {
        if (v instanceof Language_PS_CST_Types_Module.ImportType) {
            return eq(v.value0)(expectedName);
        };
        return false;
    };
})(function (name) {
    return function (currentImport) {
        return currentImport;
    };
})(function (name) {
    return new Language_PS_CST_Types_Module.ImportType(name, Data_Maybe.Nothing.value);
});
var processSmartQualifiedNameTypeOp = /* #__PURE__ */ (function () {
    return processSmartQualifiedName(function (expectedName) {
        return function (v) {
            if (v instanceof Language_PS_CST_Types_Module.ImportTypeOp) {
                return eq2(v.value0)(expectedName);
            };
            return false;
        };
    })(function (name) {
        return function (currentImport) {
            return currentImport;
        };
    })(Language_PS_CST_Types_Module.ImportTypeOp.create);
})();
var processSmartQualifiedNameValue = /* #__PURE__ */ (function () {
    return processSmartQualifiedName(function (expectedName) {
        return function (v) {
            if (v instanceof Language_PS_CST_Types_Module.ImportValue) {
                return eq3(v.value0)(expectedName);
            };
            return false;
        };
    })(function (_name) {
        return function (currentImport) {
            return currentImport;
        };
    })(Language_PS_CST_Types_Module.ImportValue.create);
})();
var processFixityOp = function (v) {
    if (v instanceof Language_PS_SmartCST_Types_Declaration.FixityValue && v.value0 instanceof Data_Either.Left) {
        return bind(processSmartQualifiedNameValue(v.value0.value0))(function (qualifiedIdent$prime) {
            return pure(new Language_PS_CST_Types_Declaration.FixityValue(new Data_Either.Left(qualifiedIdent$prime), v.value1));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.FixityValue && v.value0 instanceof Data_Either.Right) {
        return bind(processSmartQualifiedNameTypeConstructor(v.value0.value0))(function (qualifiedProperName$prime) {
            return pure(new Language_PS_CST_Types_Declaration.FixityValue(new Data_Either.Right(qualifiedProperName$prime), v.value1));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.FixityType) {
        return bind(processSmartQualifiedNameType(v.value0))(function (properName$prime) {
            return pure(new Language_PS_CST_Types_Declaration.FixityType(properName$prime, v.value1));
        });
    };
    throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 394, column 1 - line 394, column 81): " + [ v.constructor.name ]);
};
var processFixityFields = function (fixityFields) {
    return bind(processFixityOp(fixityFields.operator))(function (operator) {
        return pure({
            keyword: fixityFields.keyword,
            precedence: fixityFields.precedence,
            operator: operator
        });
    });
};
var processTypeVarBinding = function (v) {
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeVarKinded) {
        return map(Language_PS_CST_Types_Declaration.TypeVarKinded.create(v.value0))(processType(v.value1));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeVarName) {
        return pure(new Language_PS_CST_Types_Declaration.TypeVarName(v.value0));
    };
    throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 340, column 1 - line 340, column 99): " + [ v.constructor.name ]);
};
var processType = function (v) {
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeVar) {
        return pure(new Language_PS_CST_Types_Declaration.TypeVar(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeConstructor) {
        return map(Language_PS_CST_Types_Declaration.TypeConstructor.create)(processSmartQualifiedNameType(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeWildcard) {
        return pure(Language_PS_CST_Types_Declaration.TypeWildcard.value);
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeHole) {
        return pure(new Language_PS_CST_Types_Declaration.TypeHole(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeString) {
        return pure(new Language_PS_CST_Types_Declaration.TypeString(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeRow) {
        return map(Language_PS_CST_Types_Declaration.TypeRow.create)(processRow(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeRecord) {
        return map(Language_PS_CST_Types_Declaration.TypeRecord.create)(processRow(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeApp) {
        return apply(map(Language_PS_CST_Types_Declaration.TypeApp.create)(processType(v.value0)))(processType(v.value1));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeForall) {
        return apply(map(Language_PS_CST_Types_Declaration.TypeForall.create)(traverse(processTypeVarBinding)(v.value0)))(processType(v.value1));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeArr) {
        return apply(map(Language_PS_CST_Types_Declaration.TypeArr.create)(processType(v.value0)))(processType(v.value1));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeKinded) {
        return apply(map(Language_PS_CST_Types_Declaration.TypeKinded.create)(processType(v.value0)))(processType(v.value1));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeOp) {
        return apply(apply(map(Language_PS_CST_Types_Declaration.TypeOp.create)(processType(v.value0)))(processSmartQualifiedNameTypeOp(v.value1)))(processType(v.value2));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.TypeConstrained) {
        return apply(map(Language_PS_CST_Types_Declaration.TypeConstrained.create)(processConstraint(v.value0)))(processType(v.value1));
    };
    throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 349, column 1 - line 349, column 73): " + [ v.constructor.name ]);
};
var processRow = function (row) {
    return bind(traverse1(function (rowItem) {
        return map(function (v) {
            return {
                label: rowItem.label,
                type_: v
            };
        })(processType(rowItem.type_));
    })(row.rowLabels))(function (v) {
        return bind(traverse2(processType)(row.rowTail))(function (rowTail) {
            return pure({
                rowLabels: v,
                rowTail: rowTail
            });
        });
    });
};
var processConstraint = function (v) {
    return bind(processSmartQualifiedNameClass(v.className))(function (className) {
        return bind(traverse1(processType)(v.args))(function (args) {
            return pure({
                className: className,
                args: args
            });
        });
    });
};
var processDataCtor = function (v) {
    return bind(traverse1(processType)(v.dataCtorFields))(function (dataCtorFields$prime) {
        return pure({
            dataCtorName: v.dataCtorName,
            dataCtorFields: dataCtorFields$prime
        });
    });
};
var processForeign = function (v) {
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ForeignValue) {
        return bind(processType(v.value0.type_))(function (v1) {
            return pure(new Language_PS_CST_Types_Declaration.ForeignValue({
                ident: v.value0.ident,
                type_: v1
            }));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ForeignData) {
        return bind(processType(v.value0.kind_))(function (v1) {
            return pure(new Language_PS_CST_Types_Declaration.ForeignData({
                name: v.value0.name,
                kind_: v1
            }));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ForeignKind) {
        return pure(new Language_PS_CST_Types_Declaration.ForeignKind(v.value0));
    };
    throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 376, column 1 - line 376, column 78): " + [ v.constructor.name ]);
};
var processInstanceHead = function (instanceHead) {
    return bind(traverse1(processConstraint)(instanceHead.instConstraints))(function (instConstraints$prime) {
        return bind(processSmartQualifiedNameClass(instanceHead.instClass))(function (instClass$prime) {
            return bind(traverse(processType)(instanceHead.instTypes))(function (instTypes$prime) {
                return pure({
                    instName: instanceHead.instName,
                    instConstraints: instConstraints$prime,
                    instClass: instClass$prime,
                    instTypes: instTypes$prime
                });
            });
        });
    });
};
var processDataHead = function (v) {
    return bind(traverse1(processTypeVarBinding)(v.dataHdVars))(function (v1) {
        return pure({
            dataHdName: v.dataHdName,
            dataHdVars: v1
        });
    });
};
var processClassHead = function (classHead) {
    return bind(traverse1(processTypeVarBinding)(classHead.vars))(function (vars) {
        return bind(traverse1(processConstraint)(classHead["super"]))(function ($$super) {
            return pure({
                name: classHead.name,
                vars: vars,
                "super": $$super,
                fundeps: classHead.fundeps
            });
        });
    });
};
var processBinder = function (v) {
    if (v instanceof Language_PS_SmartCST_Types_Declaration.BinderNamed) {
        return bind(processBinder(v.value0.binder))(function (binder) {
            return pure(new Language_PS_CST_Types_Declaration.BinderNamed({
                ident: v.value0.ident,
                binder: binder
            }));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.BinderConstructor) {
        return bind(processSmartQualifiedNameTypeConstructor(v.value0.name))(function (name) {
            return bind(traverse1(processBinder)(v.value0.args))(function (args) {
                return pure(new Language_PS_CST_Types_Declaration.BinderConstructor({
                    name: name,
                    args: args
                }));
            });
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.BinderArray) {
        return bind(traverse1(processBinder)(v.value0))(function (binderArray$prime) {
            return pure(new Language_PS_CST_Types_Declaration.BinderArray(binderArray$prime));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.BinderRecord) {
        return bind(traverse1(traverse3(processBinder))(v.value0))(function (v1) {
            return pure(new Language_PS_CST_Types_Declaration.BinderRecord(v1));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.BinderTyped) {
        return bind(processBinder(v.value0))(function (binder$prime) {
            return bind(processType(v.value1))(function (type_$prime) {
                return pure(new Language_PS_CST_Types_Declaration.BinderTyped(binder$prime, type_$prime));
            });
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.BinderOp) {
        return bind(processBinder(v.value0))(function (binderA$prime) {
            return bind(processSmartQualifiedNameOp(v.value1))(function (qualifiedName$prime) {
                return bind(processBinder(v.value2))(function (binderB$prime) {
                    return pure(new Language_PS_CST_Types_Declaration.BinderOp(binderA$prime, qualifiedName$prime, binderB$prime));
                });
            });
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.BinderWildcard) {
        return pure(Language_PS_CST_Types_Declaration.BinderWildcard.value);
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.BinderVar) {
        return pure(new Language_PS_CST_Types_Declaration.BinderVar(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.BinderBoolean) {
        return pure(new Language_PS_CST_Types_Declaration.BinderBoolean(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.BinderChar) {
        return pure(new Language_PS_CST_Types_Declaration.BinderChar(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.BinderString) {
        return pure(new Language_PS_CST_Types_Declaration.BinderString(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.BinderNumber) {
        return pure(new Language_PS_CST_Types_Declaration.BinderNumber(v.value0));
    };
    throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 438, column 1 - line 438, column 75): " + [ v.constructor.name ]);
};
var processWhere = function (where_) {
    return bind(processExpr(where_.expr))(function (expr) {
        return bind(traverse1(processLetBinding)(where_.whereBindings))(function (whereBindings) {
            return pure({
                expr: expr,
                whereBindings: whereBindings
            });
        });
    });
};
var processValueBindingFields = function (valueBindingFields) {
    return bind(traverse1(processBinder)(valueBindingFields.binders))(function (binders) {
        return bind(processGuarded(valueBindingFields.guarded))(function (guarded) {
            return pure({
                name: valueBindingFields.name,
                binders: binders,
                guarded: guarded
            });
        });
    });
};
var processRecordUpdate = function (v) {
    if (v instanceof Language_PS_SmartCST_Types_Declaration.RecordUpdateLeaf) {
        return map(Language_PS_CST_Types_Declaration.RecordUpdateLeaf.create(v.value0))(processExpr(v.value1));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.RecordUpdateBranch) {
        return map(Language_PS_CST_Types_Declaration.RecordUpdateBranch.create(v.value0))(traverse(processRecordUpdate)(v.value1));
    };
    throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 544, column 1 - line 544, column 93): " + [ v.constructor.name ]);
};
var processRecordAccessor = function (x) {
    return bind(processExpr(x.recExpr))(function (recExpr) {
        return pure({
            recExpr: recExpr,
            recPath: x.recPath
        });
    });
};
var processPatternGuard = function (x) {
    return bind(traverse2(processBinder)(x.binder))(function (binder) {
        return bind(processExpr(x.expr))(function (expr) {
            return pure({
                binder: binder,
                expr: expr
            });
        });
    });
};
var processLetIn = function (x) {
    return bind(processExpr(x.body))(function (body) {
        return bind(traverse(processLetBinding)(x.bindings))(function (bindings) {
            return pure({
                body: body,
                bindings: bindings
            });
        });
    });
};
var processLetBinding = function (v) {
    if (v instanceof Language_PS_SmartCST_Types_Declaration.LetBindingSignature) {
        return bind(processType(v.value0.type_))(function (type_) {
            return pure(new Language_PS_CST_Types_Declaration.LetBindingSignature({
                ident: v.value0.ident,
                type_: type_
            }));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.LetBindingName) {
        return map(Language_PS_CST_Types_Declaration.LetBindingName.create)(processValueBindingFields(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.LetBindingPattern) {
        return bind(processBinder(v.value0.binder))(function (binder) {
            return bind(processWhere(v.value0.where_))(function (where_) {
                return pure(new Language_PS_CST_Types_Declaration.LetBindingPattern({
                    binder: binder,
                    where_: where_
                }));
            });
        });
    };
    throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 481, column 1 - line 481, column 87): " + [ v.constructor.name ]);
};
var processLambda = function (x) {
    return bind(traverse(processBinder)(x.binders))(function (binders) {
        return bind(processExpr(x.body))(function (body) {
            return pure({
                binders: binders,
                body: body
            });
        });
    });
};
var processIfThenElse = function (x) {
    return bind(processExpr(x.cond))(function (cond) {
        return bind(processExpr(x.true_))(function (true_) {
            return bind(processExpr(x.false_))(function (false_) {
                return pure({
                    cond: cond,
                    true_: true_,
                    false_: false_
                });
            });
        });
    });
};
var processGuardedExpr = function (guardedExpr) {
    return bind(traverse(processPatternGuard)(guardedExpr.patterns))(function (patterns) {
        return bind(processWhere(guardedExpr.where_))(function (where_) {
            return pure({
                patterns: patterns,
                where_: where_
            });
        });
    });
};
var processGuarded = function (v) {
    if (v instanceof Language_PS_SmartCST_Types_Declaration.Unconditional) {
        return map(Language_PS_CST_Types_Declaration.Unconditional.create)(processWhere(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.Guarded) {
        return map(Language_PS_CST_Types_Declaration.Guarded.create)(traverse(processGuardedExpr)(v.value0));
    };
    throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 468, column 1 - line 468, column 78): " + [ v.constructor.name ]);
};
var processExpr = function (v) {
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprHole) {
        return pure(new Language_PS_CST_Types_Declaration.ExprHole(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprSection) {
        return pure(Language_PS_CST_Types_Declaration.ExprSection.value);
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprIdent) {
        return map(Language_PS_CST_Types_Declaration.ExprIdent.create)(processSmartQualifiedNameValue(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprVar) {
        return pure(new Language_PS_CST_Types_Declaration.ExprIdent(Language_PS_CST_Sugar_QualifiedName.nonQualifiedName(v.value0)));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprConstructor) {
        return map(Language_PS_CST_Types_Declaration.ExprConstructor.create)(processSmartQualifiedNameTypeConstructor(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprBoolean) {
        return pure(new Language_PS_CST_Types_Declaration.ExprBoolean(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprChar) {
        return pure(new Language_PS_CST_Types_Declaration.ExprChar(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprString) {
        return pure(new Language_PS_CST_Types_Declaration.ExprString(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprNumber) {
        return pure(new Language_PS_CST_Types_Declaration.ExprNumber(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprArray) {
        return map(Language_PS_CST_Types_Declaration.ExprArray.create)(traverse1(processExpr)(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprRecord) {
        return map(Language_PS_CST_Types_Declaration.ExprRecord.create)(traverse1(traverse3(processExpr))(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprTyped) {
        return apply(map(Language_PS_CST_Types_Declaration.ExprTyped.create)(processExpr(v.value0)))(processType(v.value1));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprInfix) {
        return apply(apply(map(Language_PS_CST_Types_Declaration.ExprInfix.create)(processExpr(v.value0)))(processExpr(v.value1)))(processExpr(v.value2));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprOp) {
        return apply(apply(map(Language_PS_CST_Types_Declaration.ExprOp.create)(processExpr(v.value0)))(processSmartQualifiedNameOp(v.value1)))(processExpr(v.value2));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprOpName) {
        return map(Language_PS_CST_Types_Declaration.ExprOpName.create)(processSmartQualifiedNameOp(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprNegate) {
        return map(Language_PS_CST_Types_Declaration.ExprNegate.create)(processExpr(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprRecordAccessor) {
        return map(Language_PS_CST_Types_Declaration.ExprRecordAccessor.create)(processRecordAccessor(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprRecordUpdate) {
        return apply(map(Language_PS_CST_Types_Declaration.ExprRecordUpdate.create)(processExpr(v.value0)))(traverse(processRecordUpdate)(v.value1));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprApp) {
        return apply(map(Language_PS_CST_Types_Declaration.ExprApp.create)(processExpr(v.value0)))(processExpr(v.value1));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprLambda) {
        return map(Language_PS_CST_Types_Declaration.ExprLambda.create)(processLambda(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprIf) {
        return map(Language_PS_CST_Types_Declaration.ExprIf.create)(processIfThenElse(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprCase) {
        return map(Language_PS_CST_Types_Declaration.ExprCase.create)(processCaseOf(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprLet) {
        return map(Language_PS_CST_Types_Declaration.ExprLet.create)(processLetIn(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprDo) {
        return map(Language_PS_CST_Types_Declaration.ExprDo.create)(traverse(processDoStatement)(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.ExprAdo) {
        return map(Language_PS_CST_Types_Declaration.ExprAdo.create)(processAdoBlock(v.value0));
    };
    throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 509, column 1 - line 509, column 69): " + [ v.constructor.name ]);
};
var processDoStatement = function (v) {
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DoLet) {
        return map(Language_PS_CST_Types_Declaration.DoLet.create)(traverse(processLetBinding)(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DoDiscard) {
        return map(Language_PS_CST_Types_Declaration.DoDiscard.create)(processExpr(v.value0));
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DoBind) {
        return map(Language_PS_CST_Types_Declaration.DoBind.create)(apply(map(function (v1) {
            return function (v2) {
                return {
                    binder: v1,
                    expr: v2
                };
            };
        })(processBinder(v.value0.binder)))(processExpr(v.value0.expr)));
    };
    throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 586, column 1 - line 586, column 90): " + [ v.constructor.name ]);
};
var processCaseOf = function (x) {
    return bind(traverse(processExpr)(x.head))(function (head) {
        return bind(traverse(function (branch) {
            return apply(map(function (v) {
                return function (v1) {
                    return {
                        binders: v,
                        body: v1
                    };
                };
            })(traverse(processBinder)(branch.binders)))(processGuarded(branch.body));
        })(x.branches))(function (branches) {
            return pure({
                head: head,
                branches: branches
            });
        });
    });
};
var processAdoBlock = function (x) {
    return bind(traverse1(processDoStatement)(x.statements))(function (statements) {
        return bind(processExpr(x.result))(function (result) {
            return pure({
                statements: statements,
                result: result
            });
        });
    });
};
var processInstanceBinding = function (v) {
    if (v instanceof Language_PS_SmartCST_Types_Declaration.InstanceBindingSignature) {
        return bind(processType(v.value0.type_))(function (type_) {
            return pure(new Language_PS_CST_Types_Declaration.InstanceBindingSignature({
                ident: v.value0.ident,
                type_: type_
            }));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.InstanceBindingName) {
        return map(Language_PS_CST_Types_Declaration.InstanceBindingName.create)(processValueBindingFields(v.value0));
    };
    throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 600, column 1 - line 600, column 102): " + [ v.constructor.name ]);
};
var processInstance = function (x) {
    return bind(processInstanceHead(x.head))(function (head) {
        return bind(traverse1(processInstanceBinding)(x.body))(function (body) {
            return pure({
                head: head,
                body: body
            });
        });
    });
};
var processDeclaration = function (v) {
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DeclData) {
        return bind(processDataHead(v.value0.head))(function (v1) {
            return bind(traverse1(processDataCtor)(v.value0.constructors))(function (v2) {
                return pure(new Language_PS_CST_Types_Declaration.DeclData({
                    comments: v.value0.comments,
                    head: v1,
                    constructors: v2
                }));
            });
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DeclType) {
        return bind(processDataHead(v.value0.head))(function (v1) {
            return bind(processType(v.value0.type_))(function (v2) {
                return pure(new Language_PS_CST_Types_Declaration.DeclType({
                    comments: v.value0.comments,
                    head: v1,
                    type_: v2
                }));
            });
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DeclNewtype) {
        return bind(processDataHead(v.value0.head))(function (v1) {
            return bind(processType(v.value0.type_))(function (v2) {
                return pure(new Language_PS_CST_Types_Declaration.DeclNewtype({
                    comments: v.value0.comments,
                    head: v1,
                    name: v.value0.name,
                    type_: v2
                }));
            });
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DeclClass) {
        return bind(processClassHead(v.value0.head))(function (v1) {
            return bind(traverse1(function (v2) {
                return map(function (v3) {
                    return {
                        ident: v2.ident,
                        type_: v3
                    };
                })(processType(v2.type_));
            })(v.value0.methods))(function (v2) {
                return pure(new Language_PS_CST_Types_Declaration.DeclClass({
                    comments: v.value0.comments,
                    head: v1,
                    methods: v2
                }));
            });
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DeclInstanceChain) {
        return bind(traverse(processInstance)(v.value0.instances))(function (v1) {
            return pure(new Language_PS_CST_Types_Declaration.DeclInstanceChain({
                comments: v.value0.comments,
                instances: v1
            }));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DeclDerive) {
        return bind(processInstanceHead(v.value0.head))(function (v1) {
            return pure(new Language_PS_CST_Types_Declaration.DeclDerive({
                comments: v.value0.comments,
                deriveType: v.value0.deriveType,
                head: v1
            }));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DeclSignature) {
        return bind(processType(v.value0.type_))(function (v1) {
            return pure(new Language_PS_CST_Types_Declaration.DeclSignature({
                comments: v.value0.comments,
                ident: v.value0.ident,
                type_: v1
            }));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DeclValue) {
        return bind(processValueBindingFields(v.value0.valueBindingFields))(function (v1) {
            return pure(new Language_PS_CST_Types_Declaration.DeclValue({
                comments: v.value0.comments,
                valueBindingFields: v1
            }));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DeclFixity) {
        return bind(processFixityFields(v.value0.fixityFields))(function (v1) {
            return pure(new Language_PS_CST_Types_Declaration.DeclFixity({
                comments: v.value0.comments,
                fixityFields: v1
            }));
        });
    };
    if (v instanceof Language_PS_SmartCST_Types_Declaration.DeclForeign) {
        return bind(processForeign(v.value0.foreign_))(function (v1) {
            return pure(new Language_PS_CST_Types_Declaration.DeclForeign({
                comments: v.value0.comments,
                foreign_: v1
            }));
        });
    };
    throw new Error("Failed pattern match at Language.PS.SmartCST.ProcessSmartDeclaration (line 299, column 1 - line 299, column 90): " + [ v.constructor.name ]);
};
var processDeclarations = function (currentModuleName) {
    return function (x) {
        return Data_Function.flip(Control_Monad_State.runState)([  ])(Data_Function.flip(Control_Monad_Reader_Trans.runReaderT)(currentModuleName)(traverse1(processDeclaration)(x)));
    };
};
export {
    processSmartQualifiedName,
    processSmartQualifiedNameValue,
    processSmartQualifiedNameOp,
    processSmartQualifiedNameType,
    processSmartQualifiedNameTypeOp,
    processSmartQualifiedNameClass,
    processSmartQualifiedNameKind,
    processSmartQualifiedNameTypeConstructor,
    processDeclarations,
    processDeclaration,
    processDataHead,
    processTypeVarBinding,
    processDataCtor,
    processType,
    processInstanceHead,
    processForeign,
    processFixityFields,
    processFixityOp,
    processRow,
    processConstraint,
    processClassHead,
    processValueBindingFields,
    processBinder,
    processGuarded,
    processWhere,
    processLetBinding,
    processGuardedExpr,
    processPatternGuard,
    processExpr,
    processRecordAccessor,
    processRecordUpdate,
    processLambda,
    processIfThenElse,
    processCaseOf,
    processLetIn,
    processDoStatement,
    processAdoBlock,
    processInstanceBinding,
    processInstance
};
